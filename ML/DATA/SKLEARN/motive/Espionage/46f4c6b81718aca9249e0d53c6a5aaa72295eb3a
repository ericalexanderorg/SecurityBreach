LONDON - A recent attack aimed at a U.S.-based oil, gas and chemical supplier leverages the company's use of the enterprise-class Asterisk open-source PBX software, used for VoIP services. According to research from Check Point, presented here at Virus Bulletin 2019 on Friday, the attack was first identified early last year when researchers spotted scanning activity targeting 1,500 unique gateways tied to 600 companies. As a result, the adversary was able to gain complete control over the server, including being able to access databases, call recordings, metadata and detailed information on who called whom and when within the organization. The attacker injected a call file that caused the Asterisk server to make external calls and play canned messages with the identity of the victimized company. The PHP code hooked up with a command-and-control server, and downloaded a password-protected PHP web shell that carried out the data extraction, including the CALL file, which contains metadata on the calls made by the server. The attacker inserted a new CALL file into the outgoing directory, offering the ability to make outgoing calls under the guise of the victimized company. "The infection vector is a customized PHP web shell, which is weaponized with new techniques targeting the Asterisk internal configuration files and databases - the same databases that hold all of the calls' metadata as well as the recordings of the calls," according to the paper.