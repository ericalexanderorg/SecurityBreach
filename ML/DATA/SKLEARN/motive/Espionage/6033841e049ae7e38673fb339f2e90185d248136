The command is likely the first in the chain of commands used for loading a module Accept module data, and if all data is accepted, 0x402 From ?2 Command launch the module inside a container running in the same session as the stager 0x403 From ?2 Command 0x404 From C2 Command 0x405 From ?2 Command Same as 0x402, but the module is launched in a container running in a different session Write data to pipe for module launched inside a container running in the same session as the stager Write data to pipe for module launched inside a container in a different session Generate a constant by calling GetTickCount() and 0x409 From ?2 Command save it. Each module has its own descriptor created by a command from C2. The C2 server sends a byte array describing the module. The array contains information on the module: whether the module needs to be launched via export, module type, module size, entry point RVA, and module data decryption key. The pipe ending in "Fir" is used to pass data from the module to C2. The pipe ending in "Sec" is used to pass data and commands from C2 to the modules. Possibly means "Complete module operation" 0x3716 From ?2 Command Send module data to a different module 0x3A0B From ?2 Command Same as 0x3099 0x3CD0 From ?2 Command From the Response 0x129E malware Start an asynchronous TCP server to shuttle data between C2 and connected client ID of a packet containing information about the computer ID of the packet sent by C2 in response to 0x132A From ?2 Response information sent regarding the infected computer. The window handle is passed to the modules, and the dispatcher has branches not used by the stager, so we can assume that the modules can use the window for communication with C2. 21 Modules Each module is an MZPE file loaded into the same address space as the stager. Module data comes from C2 ??? Command Transmit data from LPARAM to C2 ??? Command ??? Command 0xC358 0xC359 Transmit C2 configuration to the module.