Gov/usao-wdwa/press-release/file/1188626/download.On July 19, 2019 a security researcher got in touch with Capital One via it's responsible disclosure email address notifying them that they had discovered a public Github gist which contained the description of the attack along with the target that was attacked, the commands that were run and the list of AWS S3 buckets that contained the data that was stolen. The attack to obtain the keys to gain access to S3 and the downloading of the data happened on March 22 and 23, 2019.The attacker gained access to a set of AWS access keys by accessing the AWS EC2 metadata service via a SSRF vulnerability. A sample output of what is visible when the AWS credentials for an attached IAM role are requested via the instance metadata is shown below. Adding the credentials to the local AWS CLI.Very likely the next step the attacker took was to add the discovered credentials to their local AWS CLI using the aws configure command. Once the AWS CLI is setup with the stolen keys and token, the attacker ran the command to list buckets available in the account. The IAM role would very likely allow the attacker to download an SSE-KMS-encrypted object from the S3 buckets as the role would have the neccessary permission to decrypt the AWS KMS key. Lastly, the absence of monitoring for IAM and AWS STS API Calls with AWS CloudTrail and monitoring for S3 read given the sensitive nature of data therein.